<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  
  <title>JSON基础 | Jayier&#39;s web-notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link type="text/css" rel="stylesheet" href="/css/font-awesome.min.css">
  <link type="text/css" rel="stylesheet" href="/css/style.css">
	<link rel="icon" href="/favicon.ico">
</head>

<body>
  <div class="j-container">
	<aside class="j-aside"><a class="j-logo" href="/">Jayier&#39;s web-notes</a>
<h4 class="j-title">Jayier&#39;s web-notes</h4>
<p class="j-say">每天进步一点点!</p>
<div class="j-social">
  
    <a href="https://github.com/Jayier" target="_blank" class="fa fa-github"></a>
  
    <a href="javascript:;" target="_blank" class="fa fa-weixin"></a>
  
    <a href="mailto:jay_f2e@163.com" target="_blank" class="fa fa-envelope"></a>
   
  <img src="/images/weixin.png" alt="" class="weixin" />
</div>
<nav class="j-nav">
  <ul class="j-menu">
    
    <li>
      <a href="/about">About</a>
    </li>
    
    <li>
      <a href="/archives">Archives</a>
    </li>
    
  </ul>
</nav></aside>
    <div class="j-main"><section id="post-json_basic" class="post-item">
  
    <header class="post-header">
      
  
    <h3 class="post-title" itemprop="name">
      JSON基础
    </h3>
  

    </header>
  
  <div class="post-meta">
    <span>归类于:</span>
    
  <i class="fa fa-book"></i>
    <a class="category-link" href="/categories/javascript/">javascript</a>

    <time datetime="2014-07-28T03:48:51.000Z" itemprop="datePublished">2014-07-28</time>
  </div>
  <article class="post-content">
    
      <h3 id="JSON语法">JSON语法</h3>
<p>Javascript 对象表示法 (Javascript Object Notation，简称JSON) 是一种轻量级的数据交换格式，它是一种文本格式，与语言无关；</p>
<p><strong>JSON有六种类型的值：</strong></p>
<p>对象、数组、字符串、数字、布尔值和特殊值 null；</p>
<p>JSON字符串必须是 <strong>双引号</strong> 的；</p>
<p>数字的整数首位不允许为0，数字可以是整数、实数或科学计数；</p>
<p>空白(空格符、制表符、回车符和换行符)可被插到任何值的前后，不过为了减少传输和存储成本，空白可以省略；</p>
<a id="more"></a>

<p>JSON对象是一个容纳 “名/值” 对的无序集合；</p>
<ul>
<li><p>名(key)，必须是<strong>双引号字符串</strong>；</p>
</li>
<li><p>值(value)，可以是任何类型的JSON值，包括数组和对象；</p>
</li>
</ul>
<p>JSON对象可以被无限层地嵌套；但一般应保持其结构的相对扁平是最高效的；</p>
<p>JSON数组是一个值的有序序列；其值可以是任何类型的JSON值，包括数组和对象；</p>
<p>注：最后一项不能有逗号；</p>
<p>例：</p>
<pre><code>[
    {
        "<span class="attribute">first</span>": <span class="value"><span class="string">"Jerome"</span></span>,
        "<span class="attribute">middle</span>": <span class="value"><span class="string">"Lester"</span></span>,
        "<span class="attribute">last</span>": <span class="value"><span class="string">"Howard"</span></span>,
    },
    {
        "<span class="attribute">first</span>": <span class="value"><span class="string">"Harry"</span></span>,
        "<span class="attribute">middle</span>": <span class="value"><span class="string">"Moses"</span></span>,
        "<span class="attribute">last</span>": <span class="value"><span class="string">"Howard"</span></span>,
    },
    {
        "<span class="attribute">first</span>": <span class="value"><span class="string">"Louis"</span></span>,
        "<span class="attribute">last</span>": <span class="value"><span class="string">"Feinberg"</span></span>,
    }
]
</code></pre><h3 id="安全的使用JSON">安全的使用JSON</h3>
<p>JSON特别易于用在WEB应用中，因为JSON就是Javascript。</p>
<p>使用 <code>eval()</code> 函数可以把一段JSON文本转化成一个有用的数据结构：</p>
<p><code>var myDate = eval(&#39;(&#39; + myJSONText + &#39;)’);</code></p>
<p>使用圆括号把 JSON 文本括起来是一种避免 Javascript 语法歧义的变通方案；</p>
<p><strong>使用 eval() 函数有安全问题，所以一般不建议用；</strong></p>
<p>在WEB浏览器中从服务器端获取数据的最佳技术是 <code>XMLHttpRequest</code>；</p>
<p>通过使用 <code>JSON.parse()</code> 方法替代 <code>eval()</code> 是一种最佳实践，如果有危险数据 <code>JSON.parse()</code> 将抛出一个异常； <code>!lte7</code></p>
<p>在外部数据与 <code>innerHTML</code> 进行交互时还存在另一种危险，即如果一个 HTML 文本片段包含一个 <code>&lt;script&gt;</code> 标签，那么一个恶意脚本将被执行；</p>
<h3 id="JS对象与JSON文本相互转换">JS对象与JSON文本相互转换</h3>
<h4 id="JSON-stringify()_将_JS_对象_转换为_JSON_字符串"><code>JSON.stringify()</code> 将 JS 对象 转换为 JSON 字符串</h4>
<p><code>JSON.stringify(value [, replacer] [, space])</code></p>
<p><strong>参数</strong></p>
<p>value 必选。 JavaScript 值，通常对象或数组，将转换。</p>
<p>replacer 可选。 转换结果的函数或数组。</p>
<p>如果 replacer 函数，调用 JSON.stringify 函数，传入键值和每个成员。 返回值用于代替原始值。 如果函数返回 undefined，成员被排除。 根对象的关键是空字符串：””</p>
<p>如果 replacer 是数组，因此，只有用键值的成员数组中将转换。 成员变换的顺序与键顺序的数组中。 当 value 参数也是 replacer 数组时，数组被忽略。</p>
<p>space 可选。 添加缩进、空白和换行符来返回值 JSON 文本更便于阅读。</p>
<p>如果省略 space，返回值文本生成，没有任何额外的空白。</p>
<p>如果 space 是数字，则返回值具有空白的文本缩进指定数目在每个级别的。 如果 space 大于 10 时，文本缩进 10 个空白。</p>
<p>如果 space 为非空字符串，如“\t”，返回值文本缩进与字符串的字符在每个级别。</p>
<p>如果 space 为大于 10 个字符的字符串，使用前 10 个字符。</p>
<p>如果 value 有一个 toJSON 方法，使用 JSON.stringify 函数返回值的方法。 如果 toJSON 方法的返回值与 undefined成员，不转换。 这使得对象确定自己的 JSON 表示。</p>
<p>没有 JSON 表示形式，如 undefined的值，而不会转换。 在对象，它们将被删除。 在将 null 数组，将其替换。</p>
<p>字符串值以双引号开始和结束。 所有 Unicode 字符括在引号可能除外必须使用反斜杠，转义的字符。 以下字符必须由反斜杠：</p>
<ul>
<li>引号 (“)</li>
<li>反斜杠 ()</li>
<li>退格 (B)</li>
<li>换页 (f)</li>
<li>换行符 (n)</li>
<li>回车 (r)</li>
<li>横向 (T) 表</li>
<li>四位十六进制数字 (uhhhh)</li>
</ul>
<p><strong>执行顺序</strong></p>
<p>在序列化进程中，toJSON，则方法以 value 参数，则 JSON.stringify 的第一次调用 toJSON 方法。 如果不存在，则使用值。 接下来，如果，提供 replacer 参数，值 (初始值或 toJSON 返回值) 用 replacer 参数的值替换中返回。 最后，将添加到 space 参数的值基于选项生成最终 JSON 文本。</p>
<p><strong>示例</strong></p>
<p>此示例使用 JSON.stringify 的转换为 JSON 文本的 contact 对象。 memberfilter 数组定义，以便仅 surname 和 phone 成员转换。 firstname 成员省略。</p>
<pre><code><span class="keyword">var</span> contact = <span class="keyword">new</span> <span class="built_in">Object</span>();
contact.firstname = <span class="string">"Jesper"</span>;
contact.surname = <span class="string">"Aaberg"</span>;
contact.phone = [<span class="string">"555-0100"</span>, <span class="string">"555-0120"</span>];

<span class="keyword">var</span> memberfilter = <span class="keyword">new</span> <span class="built_in">Array</span>();
memberfilter[<span class="number">0</span>] = <span class="string">"surname"</span>;
memberfilter[<span class="number">1</span>] = <span class="string">"phone"</span>;
<span class="keyword">var</span> jsonText = <span class="built_in">JSON</span>.stringify(contact, memberfilter, <span class="string">"\t"</span>);
<span class="built_in">document</span>.write(jsonText);
<span class="comment">// Output:</span>
<span class="comment">// { "surname": "Aaberg", "phone": [ "555-0100", "555-0120" ] }</span>
</code></pre><p>此示例使用与数组的 JSON.stringify。 replaceToUpper 函数转换数组中每个字符串为大写。</p>
<pre><code><span class="keyword">var</span> continents = <span class="keyword">new</span> <span class="built_in">Array</span>();
continents[<span class="number">0</span>] = <span class="string">"Europe"</span>;
continents[<span class="number">1</span>] = <span class="string">"Asia"</span>;
continents[<span class="number">2</span>] = <span class="string">"Australia"</span>;
continents[<span class="number">3</span>] = <span class="string">"Antarctica"</span>;
continents[<span class="number">4</span>] = <span class="string">"North America"</span>;
continents[<span class="number">5</span>] = <span class="string">"South America"</span>;
continents[<span class="number">6</span>] = <span class="string">"Africa"</span>;

<span class="keyword">var</span> jsonText = <span class="built_in">JSON</span>.stringify(continents, replaceToUpper);

<span class="function"><span class="keyword">function</span> <span class="title">replaceToUpper</span><span class="params">(key, value)</span> </span>{
    <span class="keyword">return</span> value.toString().toUpperCase();
}

<span class="comment">//Output:</span>
<span class="comment">// "EUROPE,ASIA,AUSTRALIA,ANTARCTICA,NORTH AMERICA,SOUTH AMERICA,AFRICA"</span>
</code></pre><p>此示例使用 toJSON 方法将字符串值转换为大写。</p>
<pre><code><span class="keyword">var</span> contact = <span class="keyword">new</span> Object();
contact.firstname = <span class="string">"Jesper"</span>;
contact.surname = <span class="string">"Aaberg"</span>;
contact.phone = [<span class="string">"555-0100"</span>, <span class="string">"555-0120"</span>];

contact.toJSON = function(key) {
    <span class="keyword">var</span> replacement = <span class="keyword">new</span> Object();
    <span class="keyword">for</span> (<span class="keyword">var</span> <span class="keyword">val</span> in <span class="keyword">this</span>)
    {
        <span class="keyword">if</span> (typeof (<span class="keyword">this</span>[<span class="keyword">val</span>]) === <span class="symbol">'strin</span>g')
            replacement[<span class="keyword">val</span>] = <span class="keyword">this</span>[<span class="keyword">val</span>].toUpperCase();
        <span class="keyword">else</span>
            replacement[<span class="keyword">val</span>] = <span class="keyword">this</span>[<span class="keyword">val</span>]
    }
    <span class="keyword">return</span> replacement;
};

<span class="keyword">var</span> jsonText = JSON.stringify(contact);
document.write(jsonText);

<span class="comment">// Output:</span>
{<span class="string">"firstname"</span>:<span class="string">"JESPER"</span>,<span class="string">"surname"</span>:<span class="string">"AABERG"</span>,<span class="string">"phone"</span>:[<span class="string">"555-0100"</span>,<span class="string">"555-0120"</span>]}
'{<span class="string">"firstname"</span>:<span class="string">"JESPER"</span>,<span class="string">"surname"</span>:<span class="string">"AABERG"</span>,<span class="string">"phone"</span>:[<span class="string">"555-0100"</span>,<span class="string">"555-0120"</span>]}'
</code></pre><h4 id="JSON-parse()_将_JSON_字符串转换为_JS_对象"><code>JSON.parse()</code> 将 JSON 字符串转换为 JS 对象</h4>
<p><code>JSON.parse(text [, reviver])</code></p>
<p><strong> 参数 </strong></p>
<p>text 必选。 一个有效的 JSON 字符串。<br>reviver 可选。 一个转换结果的函数。 将为对象的每个成员调用此函数。 如果成员包含嵌套对象，则先于父对象转换嵌套对象。 对于每个成员，会发生以下情况：</p>
<ul>
<li>如果 reviver 返回一个有效值，则成员值将替换为转换后的值。</li>
<li>如果 reviver 返回它接收的相同值，则不修改成员值。</li>
<li>如果 reviver 返回 null 或 undefined，则删除成员。</li>
</ul>
<p><strong> 示例 </strong></p>
<p>以下示例使用 JSON.parse 将 JSON 字符串转换成对象。</p>
<pre><code><span class="keyword">var</span> jsontext = '{<span class="string">"firstname"</span>:<span class="string">"Jesper"</span>,<span class="string">"surname"</span>:<span class="string">"Aaberg"</span>,<span class="string">"phone"</span>:[<span class="string">"555-0100"</span>,<span class="string">"555-0120"</span>]}';
<span class="keyword">var</span> contact = <span class="type">JSON</span>.parse(jsontext);
document.write(contact.surname + <span class="string">", "</span> + contact.firstname);

<span class="comment">// Output: Aaberg, Jesper</span>
</code></pre><p>以下示例演示了如何使用 JSON.stringify 将数组转换成 JSON 字符串，然后使用 JSON.parse 将该字符串重新转换成数组。</p>
<pre><code><span class="keyword">var</span> arr = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>];
<span class="keyword">var</span> str = <span class="built_in">JSON</span>.stringify(arr);
<span class="built_in">document</span>.write(str);
<span class="built_in">document</span>.write (<span class="string">"&lt;br/&gt;"</span>);

<span class="keyword">var</span> newArr = <span class="built_in">JSON</span>.parse(str);

<span class="keyword">while</span> (newArr.length &gt; <span class="number">0</span>) {
    <span class="built_in">document</span>.write(newArr.pop() + <span class="string">"&lt;br/&gt;"</span>);
}


<span class="comment">// Output:</span>
<span class="comment">// ["a","b","c"]</span>
<span class="comment">// c</span>
<span class="comment">// b</span>
<span class="comment">// a</span>
</code></pre><p>reviver 函数通常用于将国际标准化组织 (ISO) 日期字符串的 JSON 表示形式转换为协调世界时 (UTC) 格式 Date 对象。 此示例使用 JSON.parse 来反序列化 ISO 格式的日期字符串。</p>
<p>dateReviver函数为格式为 ISO 日期字符串的成员返回Date对象。</p>
<pre><code><span class="keyword">var</span> jsontext = <span class="string">'{ "hiredate": "2008-01-01T12:00:00Z", "birthdate": "2008-12-25T12:00:00Z" }'</span>;
<span class="keyword">var</span> dates = <span class="built_in">JSON</span>.parse(jsontext, dateReviver);
<span class="built_in">document</span>.write(dates.birthdate.toUTCString());

<span class="function"><span class="keyword">function</span> <span class="title">dateReviver</span><span class="params">(key, value)</span> </span>{
    <span class="keyword">var</span> a;
    <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">'string'</span>) {
        a = <span class="regexp">/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/</span>.exec(value);
        <span class="keyword">if</span> (a) {
            <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.UTC(+a[<span class="number">1</span>], +a[<span class="number">2</span>] - <span class="number">1</span>, +a[<span class="number">3</span>], +a[<span class="number">4</span>],
                            +a[<span class="number">5</span>], +a[<span class="number">6</span>]));
        }
    }
    <span class="keyword">return</span> value;
};

<span class="comment">// Output:</span>
<span class="comment">// Thu, 25 Dec 2008 12:00:00 UTC</span>
</code></pre><h3 id="jQuery-getJSON()">jQuery.getJSON()</h3>
<p><code>jQuery.getJSON( url [, data ] [, success(data, textStatus, jqXHR) ] )</code></p>
<ul>
<li>url，类型: String一个包含发送请求的URL字符串</li>
<li>data，类型: PlainObject，发送给服务器的字符串或Key/value键值对。</li>
<li>success(data, textStatus, jqXHR)，类型: Function()，当请求成功后执行的回调函数。</li>
</ul>
<p>这是一个Ajax函数的缩写，这相当于:</p>
<pre><code>$<span class="class">.ajax</span>(<span class="rules">{
  <span class="rule"><span class="attribute">dataType</span>:<span class="value"> <span class="string">"json"</span>,
  url: url,
  data: data,
  success: success
</span></span></span>});
</code></pre>
    
  </article>
  <footer class="post-footer">
    <span>Tags: </span>
    
  <a class="tag-link" href="/tags/js/">js</a>, <a class="tag-link" href="/tags/json/">json</a>

  </footer>
</section>

  
<nav class="post-nav">
  
    <a href="/2014/07/28/mongod_basic/" class="post-nav-prev">
      <strong class="post-nav-caption">←</strong>
      <span class="post-nav-title">
        
          MongoDB语法基础
        
      </span>
    </a>
  
  
    <a href="/2014/07/28/mvc/" class="post-nav-next">
      <span class="post-nav-title">前端MVC模式</span>
      <strong class="post-nav-caption">→</strong>
    </a>
  
</nav>

</div>
	<footer class="j-footer"><span>&copy; 2014 Jayier</span>
<em>, </em>
<span>Powered by </span><a href="http://hexo.io/" target="_blank">Hexo</a></footer>
  </div>
  <script type="text/javascript" src="/js/jquery-1.9.1.min.js"></script>
</body>
</html>